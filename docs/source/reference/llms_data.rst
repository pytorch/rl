.. currentmodule:: torchrl.data.llm

Data Structures
===============

The data representation layer provides the foundation for handling conversations and LLM outputs.

History Class
-------------

The :class:`~torchrl.data.llm.History` class is a TensorClass version of the chat format usually found in transformers. 
It provides a comprehensive API for managing conversation data with features including:

- **Text parsing and formatting**: Convert between text and structured conversation format
- **Dynamic conversation building**: Append and extend conversations
- **Multi-model support**: Automatic template detection for various model families
- **Assistant token masking**: Identify which tokens were generated by the assistant
- **Tool calling support**: Handle function calls and tool responses
- **Batch operations**: Efficient tensor operations for multiple conversations

.. autosummary::
    :toctree: generated/
    :template: rl_template.rst

    History
    ContentBase
    add_chat_template

TopK Reward Selector
--------------------

.. autosummary::
    :toctree: generated/
    :template: rl_template.rst

    TopKRewardSelector
